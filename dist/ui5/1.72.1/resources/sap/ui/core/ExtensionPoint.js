/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/Log","sap/base/util/ObjectPath","sap/ui/core/mvc/View"],function(e,n,i){"use strict";sap.ui.extensionpoint=function(n,i,t,o,r){e.warning("Do not use deprecated factory function 'sap.ui.extensionpoint'. Use 'sap.ui.core.ExtensionPoint.load' instead","sap.ui.extensionpoint",null,function(){return{type:"sap.ui.extensionpoint",name:i}});return a._factory(n,i,t,o,r)};var a=sap.ui.extensionpoint;a._factory=function(i,a,t,o,r){var s,u,c;var f=sap.ui.require("sap/ui/core/CustomizingConfiguration"),g=sap.ui.require("sap/ui/core/mvc/View"),m=sap.ui.require("sap/ui/core/Fragment");if(f){if(g&&i instanceof g){s=f.getViewExtension(i.sViewName,a,i);u=i}else if(m&&i instanceof m){s=f.getViewExtension(i.getFragmentName(),a,i);u=i._oContainingView}if(s){if(s.className){var p=sap.ui.requireSync(s.className.replace(/\./g,"/"));p=p||n.get(s.className);var l=u&&s.id?u.createId(s.id):s.id;e.info("Customizing: View extension found for extension point '"+a+"' in View '"+u.sViewName+"': "+s.className+": "+(s.viewName||s.fragmentName));if(s.className==="sap.ui.core.Fragment"){var d=new p({id:l,type:s.type,fragmentName:s.fragmentName,containingView:u});c=Array.isArray(d)?d:[d]}else if(s.className==="sap.ui.core.mvc.View"){var u=g._legacyCreate({type:s.type,viewName:s.viewName,id:l});c=[u]}else{e.warning("Customizing: Unknown extension className configured (and ignored) in Component.js for extension point '"+a+"' in View '"+u.sViewName+"': "+s.className)}}else{e.warning("Customizing: no extension className configured in Component.js for extension point '"+a+"' in View '"+u.sViewName+"': "+s.className)}}}if(!c&&typeof t==="function"){c=t()}var w=function(n){if(n&&!Array.isArray(n)){n=[n]}if(n&&o){var i=o.getMetadata().getAggregation(r);if(i){for(var t=0,s=n.length;t<s;t++){o[i._sMutator](n[t])}}else{e.error("Creating extension point failed - Tried to add extension point with name "+a+" to an aggregation of "+o.getId()+" in view "+u.sViewName+", but sAggregationName was not provided correctly and I could not find a default aggregation")}}return n||[]};if(c&&typeof c.then==="function"){return c.then(w)}else{return w(c)}};a.load=function(e){return Promise.resolve(a._factory(e.container,e.name,e.createDefaultContent))};return a});