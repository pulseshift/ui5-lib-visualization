/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/assert","../Device","./Control","./IconPool","./InvisibleText","./library","./IconRenderer","sap/ui/events/KeyCodes","sap/ui/thirdparty/jquery","sap/base/Log"],function(t,e,o,r,i,s,n,a,l,u){"use strict";var p=s.IconColor;var c=s.CSSColor;var h=function(t){if(t!=null&&t!==""&&!c.isValid(t)&&!(t in p)){u.error('"'+t+'" is not of type sap.ui.core.CSSColor nor of type sap.ui.core.IconColor.');return false}else{return true}};var g=o.extend("sap.ui.core.Icon",{metadata:{interfaces:["sap.ui.core.IFormContent"],library:"sap.ui.core",designtime:"sap/ui/core/designtime/Icon.designtime",properties:{src:{type:"sap.ui.core.URI",group:"Data",defaultValue:null},size:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},color:{type:"string",group:"Appearance",defaultValue:null},hoverColor:{type:"string",group:"Appearance",defaultValue:null},activeColor:{type:"string",group:"Appearance",defaultValue:null},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},height:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},backgroundColor:{type:"string",group:"Appearance",defaultValue:null},hoverBackgroundColor:{type:"string",group:"Appearance",defaultValue:null},activeBackgroundColor:{type:"string",group:"Appearance",defaultValue:null},decorative:{type:"boolean",group:"Accessibility",defaultValue:true},useIconTooltip:{type:"boolean",group:"Accessibility",defaultValue:true},alt:{type:"string",group:"Accessibility",defaultValue:null},noTabStop:{type:"boolean",group:"Accessibility",defaultValue:false}},aggregations:{_invisibleText:{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden"}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{press:{}}}});g.prototype[e.support.touch?"ontouchstart":"onmousedown"]=function(t){if(this.hasListeners("press")){t.setMarked()}var e=this.getActiveColor(),o=this.getActiveBackgroundColor(),r;if(e||o){if(!t.targetTouches||t.targetTouches&&t.targetTouches.length===1){r=this.$();r.addClass("sapUiIconActive");if(e){this._addColorClass(e,"color")}if(o){this._addColorClass(o,"background-color")}}}};g.prototype[e.support.touch?"ontouchend":"onmouseup"]=function(t){if(!t.targetTouches||t.targetTouches&&t.targetTouches.length===0){this.$().removeClass("sapUiIconActive");this._restoreColors(e.system.desktop?"hover":undefined)}};g.prototype.onmouseover=function(){var t=this.getHoverColor(),e=this.getHoverBackgroundColor();if(t){this._addColorClass(t,"color")}if(e){this._addColorClass(e,"background-color")}};g.prototype.onmouseout=function(){this._restoreColors()};g.prototype[e.support.touch&&!e.system.desktop?"ontap":"onclick"]=function(t){if(this.hasListeners("press")){t.setMarked()}this.firePress({})};g.prototype.onkeydown=function(t){if(t.which===a.SPACE||t.which===a.ENTER){t.preventDefault();var e=this.$(),o=this.getActiveColor(),r=this.getActiveBackgroundColor();e.addClass("sapUiIconActive");if(o){this._addColorClass(o,"color")}if(r){this._addColorClass(r,"background-color")}}};g.prototype.onkeyup=function(t){if(t.which===a.SPACE||t.which===a.ENTER){this.$().removeClass("sapUiIconActive");this._restoreColors();this.firePress({})}};g.prototype._restoreColors=function(t){var e,o;if(t==="hover"){e=this.getHoverColor();o=this.getHoverBackgroundColor()}e=e||this.getColor();o=o||this.getBackgroundColor();this._addColorClass(e||"","color");this._addColorClass(o||"","background-color")};g.prototype.setSrc=function(e){t(e==null||r.isIconURI(e),this+": Property 'src' (value: '"+e+"') should be a valid Icon URI (sap-icon://...)");var o=r.getIconInfo(e,undefined,"mixed"),i=this.$(),s,n,a,l,u;this.setProperty("src",e,!!o);if(o instanceof Promise){o.then(this.invalidate.bind(this))}else if(o&&i.length){i.css("font-family",o.fontFamily);i.attr("data-sap-ui-icon-content",o.content);i.toggleClass("sapUiIconMirrorInRTL",!o.suppressMirroring);n=this.getTooltip_AsString();l=this.getAriaLabelledBy();a=this.getUseIconTooltip();s=this._getIconLabel(o);if(n||a&&o.text){i.attr("title",n||o.text)}else{i.attr("title",null)}if(l.length===0){if(s){i.attr("aria-label",s)}else{i.attr("aria-label",null)}}else{u=this.getAggregation("_invisibleText");if(u){u.setText(s)}}}return this};g.prototype.setWidth=function(t){this.setProperty("width",t,true);this.$().css("width",t);return this};g.prototype.setHeight=function(t){this.setProperty("height",t,true);this.$().css({height:t,"line-height":t});return this};g.prototype.setSize=function(t){this.setProperty("size",t,true);this.$().css("font-size",t);return this};g.prototype.setColor=function(t){if(h(t)){this.setProperty("color",t,true);this._addColorClass(t,"color")}return this};g.prototype._addColorClass=function(t,e){var o=this.$(),r=this;var i="";if(e==="color"){i="sapUiIconColor"}else if(e==="background-color"){i="sapUiIconBGColor"}else{return}l.each(p,function(t,e){r.removeStyleClass(i+e)});if(t in p){o.css(e,"");this.addStyleClass(i+t)}else{o.css(e,t)}};g.prototype.setActiveColor=function(t){if(h(t)){return this.setProperty("activeColor",t,true)}return this};g.prototype.setHoverColor=function(t){if(h(t)){return this.setProperty("hoverColor",t,true)}return this};g.prototype.setBackgroundColor=function(t){if(h(t)){this.setProperty("backgroundColor",t,true);this._addColorClass(t,"background-color")}return this};g.prototype.setActiveBackgroundColor=function(t){if(h(t)){return this.setProperty("activeBackgroundColor",t,true)}return this};g.prototype.setHoverBackgroundColor=function(t){if(h(t)){return this.setProperty("hoverBackgroundColor",t,true)}return this};g.prototype.attachPress=function(){var t=Array.prototype.slice.apply(arguments);t.unshift("press");o.prototype.attachEvent.apply(this,t);if(this.hasListeners("press")){this.$().toggleClass("sapUiIconPointer",true).attr({role:"button",tabindex:this.getNoTabStop()?undefined:0})}return this};g.prototype.detachPress=function(){var t=Array.prototype.slice.apply(arguments);t.unshift("press");o.prototype.detachEvent.apply(this,t);if(!this.hasListeners("press")){this.$().toggleClass("sapUiIconPointer",false).attr({role:this.getDecorative()?"presentation":"img"}).removeAttr("tabindex")}return this};g.prototype._getOutputTitle=function(t){var e=this.getTooltip_AsString(),o=this.getUseIconTooltip();if(e||o&&t&&t.text){return e||t.text}};g.prototype._getIconLabel=function(t){var e=this.getAlt(),o=this.getTooltip_AsString(),r=this.getUseIconTooltip(),i=e||o||r&&t&&(t.text||t.name),s=this._getOutputTitle(t);if(i&&i!==s){return i}};g.prototype._createInvisibleText=function(t){var e=this.getAggregation("_invisibleText");if(!e){e=new i(this.getId()+"-label",{text:t});this.setAggregation("_invisibleText",e,true)}else{e.setProperty("text",t,true)}return e};g.prototype._getAccessibilityAttributes=function(t){var e=this.getAriaLabelledBy(),o={},r=this._getIconLabel(t),i;if(this.getDecorative()){o.role="presentation";o.hidden="true"}else{if(this.hasListeners("press")){o.role="button"}else{o.role="img"}}if(e.length>0){if(r){i=this._createInvisibleText(r);e.push(i.getId())}o.labelledby=e.join(" ")}else if(r){o.label=r}return o};g.prototype.getAccessibilityInfo=function(){if(this.getDecorative()){return null}var t=this.hasListeners("press");var e=r.getIconInfo(this.getSrc(),undefined,"sync");return{role:t?"button":"img",type:sap.ui.getCore().getLibraryResourceBundle("sap.ui.core").getText(t?"ACC_CTR_TYPE_BUTTON":"ACC_CTR_TYPE_IMAGE"),description:this.getAlt()||this.getTooltip_AsString()||(e?e.text||e.name:""),focusable:t}};return g});