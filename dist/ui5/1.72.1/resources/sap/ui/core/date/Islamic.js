/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./UniversalDate","../CalendarType","sap/base/Log"],function(t,e,a){"use strict";var r=t.extend("sap.ui.core.date.Islamic",{constructor:function(){var t=arguments;if(t.length>1){t=y(t)}this.oDate=this.createDate(Date,t);this.sCalendarType=e.Islamic}});r.UTC=function(){var t=y(arguments);return Date.UTC.apply(Date,t)};r.now=function(){return Date.now()};var o=1400,n=1721425.5,i=1948439.5,s=-425215872e5,u=864e5;var f=null;var h=["A","B"];function l(t){var e=t.year,a=t.month,r=t.day,o,s,u,f,h,l,c;l=0;if(a+1>2){l=C(e)?-1:-2}c=n-1+365*(e-1)+Math.floor((e-1)/4)+-Math.floor((e-1)/100)+Math.floor((e-1)/400)+Math.floor((367*(a+1)-362)/12+l+r);c=Math.floor(c)+.5;h=c-i;f=Math.floor(h/29.530588853);if(f<0){o=Math.floor(f/12)+1;s=f%12;if(s<0){s+=12}u=h-d(o,s)+1}else{f++;while(p(f)>h){f--}o=Math.floor(f/12)+1;s=f%12;u=h-p(12*(o-1)+s)+1}return{day:u,month:s,year:o}}function c(t){var e=t.year,a=t.month,r=t.day,o=e<1?d(e,a):p(12*(e-1)+a),s=r+o+i-1,u=Math.floor(s-.5)+.5,f=u-n,h=Math.floor(f/146097),l=M(f,146097),c=Math.floor(l/36524),y=M(l,36524),m=Math.floor(y/1461),g=M(y,1461),I=Math.floor(g/365),v=h*400+c*100+m*4+I,T,D,U,_,F,Y,w,b;if(!(c==4||I==4)){v++}U=n+365*(v-1)+Math.floor((v-1)/4)-Math.floor((v-1)/100)+Math.floor((v-1)/400);_=u-U;F=n-1+365*(v-1)+Math.floor((v-1)/4)-Math.floor((v-1)/100)+Math.floor((v-1)/400)+Math.floor(739/12+(C(v)?-1:-2)+1);w=0;if(u<F){w=0}else{w=C(v)?1:2}T=Math.floor(((_+w)*12+373)/367);Y=n-1+365*(v-1)+Math.floor((v-1)/4)-Math.floor((v-1)/100)+Math.floor((v-1)/400);b=0;if(T>2){b=C(v)?-1:-2}Y+=Math.floor((367*T-362)/12+b+1);D=u-Y+1;return{day:D,month:T-1,year:v}}function y(t){var e=Array.prototype.slice.call(t),a,r;a={year:t[0],month:t[1],day:t[2]!==undefined?t[2]:1};r=c(a);e[0]=r.year;e[1]=r.month;e[2]=r.day;return e}function m(){var t,e;f={};t=sap.ui.getCore().getConfiguration().getFormatSettings().getLegacyDateFormat();t=I(t)?t:"A";e=sap.ui.getCore().getConfiguration().getFormatSettings().getLegacyDateCalendarCustomizing();e=e||[];if(!e.length){a.warning("No calendar customizations.");return}e.forEach(function(e){if(e.dateFormat===t){var a=g(e.gregDate);var r=new Date(Date.UTC(a.year,a.month-1,a.day));var o=r.getTime();var n=(o-s)/u;a=g(e.islamicMonthStart);var i=(a.year-1)*12+a.month-1;f[i]=n}});a.info("Working with date format: ["+t+"] and customization: "+JSON.stringify(e))}function g(t){return{year:parseInt(t.substr(0,4)),month:parseInt(t.substr(4,2)),day:parseInt(t.substr(6,2))}}function p(t){if(!f){m()}var e=f[t];if(!e){var a=Math.floor(t/12)+1;var r=t%12;e=d(a,r)}return e}function d(t,e){return Math.ceil(29.5*e)+(t-1)*354+Math.floor((3+11*t)/30)}function M(t,e){return t-e*Math.floor(t/e)}function C(t){return!(t%400)||!(t%4)&&!!(t%100)}function I(t){return h.indexOf(t)!==-1}r.prototype._getIslamic=function(){return l({day:this.oDate.getDate(),month:this.oDate.getMonth(),year:this.oDate.getFullYear()})};r.prototype._setIslamic=function(t){var e=c(t);return this.oDate.setFullYear(e.year,e.month,e.day)};r.prototype._getUTCIslamic=function(){return l({day:this.oDate.getUTCDate(),month:this.oDate.getUTCMonth(),year:this.oDate.getUTCFullYear()})};r.prototype._setUTCIslamic=function(t){var e=c(t);return this.oDate.setUTCFullYear(e.year,e.month,e.day)};r.prototype.getDate=function(t){return this._getIslamic().day};r.prototype.getMonth=function(){return this._getIslamic().month};r.prototype.getYear=function(){return this._getIslamic().year-o};r.prototype.getFullYear=function(){return this._getIslamic().year};r.prototype.setDate=function(t){var e=this._getIslamic();e.day=t;return this._setIslamic(e)};r.prototype.setMonth=function(t,e){var a=this._getIslamic();a.month=t;if(e!==undefined){a.day=e}return this._setIslamic(a)};r.prototype.setYear=function(t){var e=this._getIslamic();e.year=t+o;return this._setIslamic(e)};r.prototype.setFullYear=function(t,e,a){var r=this._getIslamic();r.year=t;if(e!==undefined){r.month=e}if(a!==undefined){r.day=a}return this._setIslamic(r)};r.prototype.getUTCDate=function(t){return this._getUTCIslamic().day};r.prototype.getUTCMonth=function(){return this._getUTCIslamic().month};r.prototype.getUTCFullYear=function(){return this._getUTCIslamic().year};r.prototype.setUTCDate=function(t){var e=this._getUTCIslamic();e.day=t;return this._setUTCIslamic(e)};r.prototype.setUTCMonth=function(t,e){var a=this._getUTCIslamic();a.month=t;if(e!==undefined){a.day=e}return this._setUTCIslamic(a)};r.prototype.setUTCFullYear=function(t,e,a){var r=this._getUTCIslamic();r.year=t;if(e!==undefined){r.month=e}if(a!==undefined){r.day=a}return this._setUTCIslamic(r)};return r});