/*!

 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./Binding","./Filter","./Sorter","sap/base/util/array/diff"],function(t,e,i,n){"use strict";var r=t.extend("sap.ui.model.ListBinding",{constructor:function(n,r,a,s,h,u){t.call(this,n,r,a,u);this.aSorters=o(s,i);this.aFilters=[];this.aApplicationFilters=o(h,e);this.oCombinedFilter=null;this.bUseExtendedChangeDetection=false;this.bDetectUpdates=true},metadata:{abstract:true,publicMethods:["getContexts","getCurrentContexts","sort","attachSort","detachSort","filter","attachFilter","detachFilter","getDistinctValues","isGrouped","getLength","isLengthFinal"]}});function o(t,e){if(Array.isArray(t)){return t}return t instanceof e?[t]:[]}r.prototype.getCurrentContexts=function(){return this.getContexts()};r.prototype.getLength=function(){return 0};r.prototype.isLengthFinal=function(){return true};r.prototype.getDistinctValues=function(t){return null};r.prototype.attachSort=function(t,e){this.attachEvent("sort",t,e)};r.prototype.detachSort=function(t,e){this.detachEvent("sort",t,e)};r.prototype._fireSort=function(t){this.fireEvent("sort",t)};r.prototype.attachFilter=function(t,e){this.attachEvent("filter",t,e)};r.prototype.detachFilter=function(t,e){this.detachEvent("filter",t,e)};r.prototype._fireFilter=function(t){this.fireEvent("filter",t)};r.prototype.isGrouped=function(){return!!(this.aSorters&&this.aSorters[0]&&this.aSorters[0].fnGroup)};r.prototype.getGroup=function(t){return this.aSorters[0].getGroup(t)};r.prototype.diffData=function(t,e){return n(t,e,this.oExtendedChangeDetectionConfig)};r.prototype.enableExtendedChangeDetection=function(t,e,i){this.bUseExtendedChangeDetection=true;this.bDetectUpdates=t;this.oExtendedChangeDetectionConfig=i;if(typeof e==="string"){this.getEntryKey=function(t){return t.getProperty(e)}}else if(typeof e==="function"){this.getEntryKey=e}if(this.update){this.update()}};r.prototype.getContextData=function(t){var e;if(this.getEntryKey&&!this.bDetectUpdates){e=this.getEntryKey(t);if(this.isGrouped()){e+="-"+this.getGroup(t).key}}else{e=this.getEntryData(t)}return e};r.prototype.getEntryData=function(t){return JSON.stringify(t.getObject())};r.prototype.getFilterInfo=function(t){if(this.oCombinedFilter){return this.oCombinedFilter.getAST(t)}return null};r.prototype.checkDataState=function(t){var e=this.oModel?this.oModel.resolve(this.sPath,this.oContext):null,i=this.getDataState();if(!t||e&&e in t){if(e){i.setModelMessages(this.oModel.getMessagesByPath(e))}this._fireDateStateChange(i)}};r.prototype._fireDateStateChange=function(t){var e=this;function i(){e.fireEvent("AggregatedDataStateChange",{dataState:t});t.changed(false);e._sDataStateTimout=null}if(t&&t.changed()){if(this.mEventRegistry["DataStateChange"]){this.fireEvent("DataStateChange",{dataState:t})}if(this.bIsBeingDestroyed){i()}else if(this.mEventRegistry["AggregatedDataStateChange"]){if(!this._sDataStateTimout){this._sDataStateTimout=setTimeout(i,0)}}}};return r});