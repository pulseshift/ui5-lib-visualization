/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/each","../base/Object","sap/base/util/deepEqual"],function(e,t,r){"use strict";var s=t.extend("sap.ui.model.DataState",{metadata:{},constructor:function(){this.mProperties={modelMessages:[],controlMessages:[],laundering:false,originalValue:undefined,originalInternalValue:undefined,value:undefined,invalidValue:undefined,internalValue:undefined,dirty:false,messages:[]};this.mChangedProperties=Object.assign({},this.mProperties)}});s.prototype._sortMessages=function(e){var t={Error:0,Warning:1,Success:2,Info:3};e.sort(function(e,r){return t[e.type]-t[r.type]})};s.prototype.setProperty=function(e,t){this.mChangedProperties[e]=t;return this};s.prototype.calculateChanges=function(){for(var e in this.mChangedProperties){var t=this.mChangedProperties[e].value;if(!r(this.mProperties[e],t)){if(Array.isArray(t)){t=t.slice(0)}this.mProperties[e]=t}}return this};s.prototype.getProperty=function(e){return this.mChangedProperties[e]};s.prototype.getMessages=function(){var e=[];var t=this.mChangedProperties["controlMessages"];var r=this.mChangedProperties["modelMessages"];if(r||t){e=e.concat(r?r:[],t?t:[]);this._sortMessages(e)}return e};s.prototype._getOldMessages=function(){var e=[];var t=this.mProperties["controlMessages"];var r=this.mProperties["modelMessages"];if(r||t){e=e.concat(r?r:[],t?t:[]);this._sortMessages(e)}return e};s.prototype.setModelMessages=function(e){this.mChangedProperties["modelMessages"]=e||[];return this};s.prototype.getModelMessages=function(){return this.getProperty("modelMessages")};s.prototype.setControlMessages=function(e){this.mChangedProperties["controlMessages"]=e||[];return this};s.prototype.getControlMessages=function(){return this.getProperty("controlMessages")};s.prototype.isDirty=function(){var e=this.mChangedProperties["value"];var t=this.mChangedProperties["originalValue"];var s=this.mChangedProperties["invalidValue"]!==undefined;return s||!r(e,t)};s.prototype.isControlDirty=function(){return this.mChangedProperties["invalidValue"]!==undefined};s.prototype.isLaundering=function(){return this.mChangedProperties["laundering"]};s.prototype.setLaundering=function(e){this.mChangedProperties["laundering"]=e;return this};s.prototype.getValue=function(e){return this.getProperty("value")};s.prototype.setValue=function(e){this.mChangedProperties["value"]=e;return this};s.prototype.getInvalidValue=function(){return this.getProperty("invalidValue")};s.prototype.setInvalidValue=function(e){this.mChangedProperties["invalidValue"]=e;return this};s.prototype.getOriginalValue=function(){return this.getProperty("originalValue")};s.prototype.setOriginalValue=function(e){this.mChangedProperties["originalValue"]=e;return this};s.prototype.changed=function(e){if(e===false){this.mProperties=Object.assign({},this.mChangedProperties)}return!r(this.mChangedProperties,this.mProperties)};s.prototype.getChanges=function(){var t={};e(this.mChangedProperties,function(e,s){if(!r(this.mChangedProperties[e],this.mProperties[e])){t[e]={};t[e].value=this.mChangedProperties[e];t[e].oldValue=this.mProperties[e]}}.bind(this));var s=this.getMessages();var i=this._getOldMessages();if(s.length>0||i.length>0){t["messages"]={};t["messages"].oldValue=i;t["messages"].value=s}return t};return s});